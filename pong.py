import math, random
from collections import defaultdict
import gym
from gym import wrappers, logger
import numpy

import collections, random


#Qlearning class taken from  Blackjack assignment
class QLearningAlgorithm():
    def __init__(self, actions, discount, featureExtractor, explorationProb):
        self.actions = actions
        self.discount = discount
        self.featureExtractor = featureExtractor
        self.explorationProb = explorationProb
        #s = ((("curBall", 50, 70, 0),  3.0414148930071025e-05), (("curBall", 190, 50, 3),  -0.0028684751094561495), (("curBall", 70, 40, 0),  0.0), (("curBall", 30, 130, 0),  0.0), (("vx+", 3),  -0.2365040055792922), (("curBall", 40, 30, 3),  0.028404444777068216), (("curBall", 140, 150, 2),  -0.041744261097886225), (("curBall", 150, 150, 2),  -0.039860779930175505), (("agentPaddle", 190, 3),  -0.030352855140875126), (("curBall", 170, 60, 2),  0.0001283719752308655), (("curBall", 130, 70, 3),  0.004102368140150276), (("curBall", 100, 130, 0),  0.0), (("curBall", 60, 40, 0),  -0.00023420407396779116), (("curBall", 150, 100, 3),  0.001417896270675267), (("curBall", 100, 160, 2),  -0.14579361745090685), (("curBall", 90, 20, 3),  -0.03675008304210318), (("curBall", 110, 40, 2),  0.0052721695265286455), (("curBall", 70, 50, 3),  0.008114188383916053), (("curBall", 120, 110, 0),  -0.00021530656677070276), (("curBall", 50, 40, 3),  0.018696104272084475), (("curBall", 80, 80, 3),  0.0023598146707891716), (("curBall", 80, 50, 0),  -8.173103132146399e-06), (("curBall", 190, 80, 2),  -9.444968684691249e-05), (("agentPaddle", 140, 0),  0.00034058369256137467), (("curBall", 30, 60, 3),  -9.50763841794373e-05), (("curBall", 90, 50, 3),  0.004996873022466378), (("curBall", 30, 130, 2),  0.0052506107615245805), (("curBall", 100, 90, 3),  0.0024834755797072164), (("curBall", 60, 10, 2),  0.027010010456367063), (("curBall", 190, 130, 2),  -4.753079588290141e-05), (("agentPaddle", 100, 2),  -0.028281580630889133), (("curBall", 170, 90, 3),  0.0023752187614801573), (("curBall", 170, 120, 0),  0.0), (("curBall", 120, 140, 0),  0.0), (("curBall", 30, 70, 0),  0.0), (("curBall", 70, 20, 3),  -0.005839926903162706), (("curBall", 160, 60, 0),  0.00034749500881327554), (("curBall", 140, 160, 2),  -0.011931114347682292), (("curBall", 40, 90, 0),  0.0), (("curBall", 140, 40, 0),  0.0), (("curBall", 40, 40, 2),  0.014407609544311835), (("curBall", 40, 100, 0),  0.0), (("curBall", 160, 100, 3),  0.003919059668286052), (("curBall", 130, 40, 3),  0.0019638866954332975), (("curBall", 90, 10, 3),  3.0058522768931123e-05), (("curBall", 150, 130, 0),  0.0), (("curBall", 160, 30, 2),  -0.0009954813666268804), (("curBall", 50, 30, 3),  -0.005874039766741024), (("curBall", 50, 60, 0),  0.0), (("curBall", 180, 70, 3),  0.0014157864881806223), (("curBall", 80, 110, 3),  0.009876153457565621), (("curBall", 130, 20, 0),  -0.004746552189956863), (("curBall", 150, 30, 0),  0.0), (("agentPaddle", 110, 2),  -0.013743511577809267), (("curBall", 40, 70, 2),  0.017358354790373114), (("curBall", 180, 40, 3),  -0.0002963500286581352), (("curBall", 170, 10, 2),  0.0002581653358091188), (("agentPaddle", 30, 3),  -0.029545802537692224), (("agentPaddle", 70, 0),  -0.02425619966116752), (("curBall", 70, 0, 0),  0.0), (("curBall", 140, 70, 3),  0.0017791155907907854), (("curBall", 140, 150, 0),  -0.0026423974526702584), (("curBall", 150, 120, 0),  0.0), (("curBall", 150, 60, 2),  0.00036543506340746927), (("curBall", 170, 30, 2),  -0.017530716118861412), (("curBall", 120, 20, 2),  -0.023465013508171872), (("curBall", 160, 100, 2),  0.004175858656079029), (("curBall", 190, 70, 2),  -0.0018328732128527958), (("ballAbove", 2),  -0.05664032250345303), (("curBall", 160, 150, 3),  -0.07830272764079553), (("curBall", 90, 90, 2),  0.004447826019192508), (("curBall", 100, 50, 2),  0.008953657393584237), (("curBall", 180, 150, 2),  -0.07212005336643618), (("curBall", 110, 80, 2),  0.03467254731130631), (("curBall", 140, 30, 2),  -0.0005682241912997711), (("curBall", 120, 50, 2),  0.0038449405012783455), (("curBall", 80, 40, 3),  0.005316207072188496), (("curBall", 130, 70, 2),  0.0020487761227369413), (("curBall", 170, 100, 3),  0.0015758827414139667), (("curBall", 190, 120, 2),  -0.003083849906865422), (("curBall", 180, 120, 2),  0.0008791869564531039), (("curBall", 80, 130, 2),  0.0005599513255032158), (("curBall", 160, 160, 3),  -0.12783733186550802), (("curBall", 90, 120, 0),  0.00013534313625879457), (("curBall", 30, 90, 3),  0.004478175014949402), (("curBall", 140, 80, 3),  0.0059932954980427946), (("curBall", 100, 50, 0),  4.4594792043181625e-05), (("curBall", 130, 70, 0),  0.0), (("agentPaddle", 90, 3),  -0.01785642225946531), (("curBall", 130, 120, 0),  0.0), (("agentPaddle", 130, 0),  -0.011507386475418442), (("curBall", 110, 20, 0),  0.0), (("curBall", 50, 110, 0),  0.0), (("ballAbove", 3),  -0.17042168007478695), (("curBall", 40, 80, 2),  0.018225564886437916), (("curBall", 40, 140, 0),  0.0), (("curBall", 130, 120, 2),  0.0043591551340179885), (("curBall", 90, 140, 2),  0.00596102795156894), (("curBall", 30, 160, 2),  -0.006255752693280284), (("curBall", 130, 120, 3),  0.004882779230470859), (("curBall", 140, 50, 2),  0.0029444525094193194), (("curBall", 30, 50, 3),  0.0015290898074202762), (("curBall", 150, 50, 2),  0.0026151555780774107), (("curBall", 120, 10, 3),  0.005062468511831976), (("curBall", 40, 50, 0),  0.0), (("curBall", 80, 30, 3),  -0.0004473908635357829), (("curBall", 40, 110, 2),  0.01103829142816797), (("agentPaddle", 180, 2),  -0.0026440831969393383), (("curBall", 170, 50, 2),  -0.0001792308258759055), (("curBall", 120, 100, 3),  0.003404073531463727), (("curBall", 70, 120, 0),  7.4623603320738515e-06), (("curBall", 170, 20, 3),  -0.057691812281891075), (("curBall", 130, 110, 0),  -0.0032308049589045464), (("curBall", 150, 80, 0),  0.0), (("curBall", 30, 20, 3),  -0.00012740000061059394), (("curBall", 150, 20, 2),  -0.00435829136969769), (("curBall", 180, 0, 0),  0.0), (("curBall", 120, 60, 2),  0.002116680430117773), (("curBall", 190, 110, 2),  -0.003037585211298742), (("curBall", 110, 0, 3),  0.055265078788702925), (("curBall", 30, 10, 3),  0.0), (("curBall", 80, 120, 0),  0.0039936085574645026), (("curBall", 130, 140, 2),  0.040710689380898335), (("vy+", 2),  -0.14721255630153277), (("curBall", 110, 40, 3),  0.0048150765695900806), (("curBall", 110, 120, 2),  0.004312676583096821), (("curBall", 120, 30, 0),  0.0), (("curBall", 110, 140, 2),  -0.0016288165668210072), (("agentPaddle", 190, 2),  0.014551075738637374), (("curBall", 190, 0, 2),  -0.08352539518077522), (("agentPaddle", 40, 3),  -0.03954957819880857), (("agentPaddle", 150, 0),  -0.04456841619180071), (("agentPaddle", 120, 2),  -0.019893152978196875), (("curBall", 180, 110, 3),  0.001031405723306551), (("curBall", 50, 160, 2),  -0.006283461044317136), (("curBall", 130, 30, 3),  -0.0072806374114307345), (("curBall", 70, 100, 3),  0.0009787112233086753), (("ballAbove", 0),  -0.13779457112145047), (("curBall", 40, 0, 3),  0.014142990214741661), (("curBall", 100, 110, 0),  0.0), (("curBall", 60, 80, 0),  0.0), (("curBall", 180, 80, 3),  0.0010385562928101777), (("curBall", 110, 30, 3),  0.0012320485600035226), (("curBall", 110, 60, 0),  0.0), (("curBall", 140, 120, 0),  0.0), (("curBall", 70, 10, 3),  0.019663066220860947), (("agentPaddle", 60, 0),  -0.01225067620902233), (("curBall", 40, 120, 2),  0.011520567366416918), (("curBall", 30, 120, 2),  0.015230966728922593), (("curBall", 60, 50, 2),  0.008353178512998148), (("curBall", 130, 100, 3),  0.00982186768487864), (("curBall", 170, 0, 0),  0.0), (("curBall", 190, 50, 0),  -0.00018032525703879276), (("curBall", 100, 160, 3),  -0.09511537047308155), (("curBall", 80, 140, 2),  0.002731914663571653), (("curBall", 60, 20, 2),  -0.05497289966676125), (("curBall", 70, 160, 3),  -0.04170250476884753), (("curBall", 40, 150, 2),  -0.3027542852235235), (("curBall", 50, 150, 2),  -0.07242092971441226), (("curBall", 140, 60, 2),  0.001691979728074968), (("curBall", 70, 80, 0),  -3.8152462309618306e-07), (("curBall", 140, 150, 3),  -0.04729164338352278), (("curBall", 150, 150, 3),  -0.05379629277619697), (("curBall", 100, 60, 2),  0.007025515449298227), (("curBall", 170, 60, 3),  0.0021325161003731487), (("curBall", 30, 90, 0),  0.0), (("curBall", 150, 40, 0),  0.0), (("curBall", 80, 30, 2),  0.0004393525377517747), (("vy-", 3),  -0.15313224510089204), (("curBall", 90, 80, 0),  0.0), (("curBall", 30, 160, 3),  -0.002052316046767311), (("agentPaddle", 30, 2),  -0.013974261181133792), (("agentPaddle", 70, 3),  -0.033062966672596894), (("curBall", 70, 50, 0),  0.0), (("curBall", 110, 150, 0),  -0.054831156819068104), (("curBall", 80, 80, 0),  0.0), (("curBall", 100, 30, 0),  0.0), (("curBall", 190, 80, 3),  -0.0009459559351409892), (("curBall", 130, 100, 2),  0.00458369137344036), (("curBall", 180, 130, 0),  0.0), (("curBall", 90, 50, 0),  0.0), (("curBall", 70, 20, 0),  0.0), (("curBall", 60, 10, 3),  0.03188311511509591), (("curBall", 120, 140, 3),  0.0378666275127338), (("curBall", 190, 130, 3),  0.002166876724623512), (("curBall", 190, 160, 0),  0.009100548859725123), (("curBall", 170, 90, 0),  0.0), (("curBall", 160, 70, 2),  0.00043912167300833553), (("curBall", 130, 130, 2),  0.009895266913712425), (("curBall", 190, 40, 2),  -0.0014109555961927308), (("curBall", 190, 10, 0),  0.0), (("curBall", 110, 70, 2),  0.018974573225035363), (("curBall", 190, 10, 2),  0.019989309959368297), (("curBall", 140, 160, 3),  0.0025039730824495702), (("curBall", 140, 130, 0),  0.0), (("curBall", 140, 10, 2),  0.0), (("curBall", 40, 40, 3),  0.018488042495880905), (("curBall", 60, 100, 2),  0.005819099274778556), (("curBall", 60, 120, 0),  0.0023083446150811517), (("curBall", 90, 10, 0),  0.0), (("curBall", 160, 30, 3),  -0.007206344896876835), (("curBall", 50, 30, 0),  0.0), (("curBall", 170, 150, 2),  -0.029252430705022085), (("curBall", 30, 150, 2),  -0.017880825039443545), (("curBall", 150, 90, 3),  0.0002612700903793034), (("curBall", 60, 100, 0),  0.000916406560243162), (("curBall", 90, 160, 0),  0.0), (("curBall", 40, 70, 3),  0.022303994732178305), (("curBall", 60, 90, 2),  0.0053739552894186355), (("curBall", 110, 130, 2),  0.0071108460521436215), (("curBall", 100, 160, 0),  0.0), (("curBall", 170, 10, 3),  0.0004591018412436316), (("curBall", 170, 40, 0),  0.0), (("curBall", 130, 90, 2),  0.0059099105652179375), (("agentPaddle", 120, 3),  -0.022537652214978776), (("curBall", 80, 100, 2),  0.006207619619458996), (("curBall", 60, 60, 2),  0.003304066362903646), (("curBall", 150, 60, 3),  0.0006678820697148124), (("curBall", 50, 90, 2),  0.002174061378747451), (("curBall", 180, 10, 2),  0.007670254298851608), (("curBall", 120, 20, 3),  -0.023179666984204154), (("curBall", 190, 70, 3),  -0.002055974538690452), (("curBall", 30, 110, 2),  0.02751586043624795), (("curBall", 90, 90, 3),  0.004786962680198468), (("curBall", 60, 30, 0),  0.0), (("curBall", 100, 50, 3),  0.0009691332413883172), (("curBall", 50, 140, 0),  0.0), (("curBall", 180, 150, 3),  -0.025809047443400523), (("curBall", 190, 30, 2),  -0.0003933454661692607), (("curBall", 110, 80, 3),  0.010974501342865237), (("curBall", 120, 50, 3),  0.0032871634195584735), (("curBall", 80, 40, 0),  0.0), (("curBall", 100, 20, 3),  -0.021014453012625837), (("curBall", 160, 40, 2),  0.000454852229224744), (("curBall", 190, 120, 3),  0.0003762472336284327), (("curBall", 180, 120, 3),  0.0031530191580544363), (("curBall", 80, 130, 3),  0.001581554169194044), (("curBall", 160, 160, 0),  0.0), (("agentPaddle", 160, 0),  0.008359870075013286), (("curBall", 140, 80, 0),  0.0), (("agentPaddle", 80, 0),  0.0029178201927278474), (("curBall", 60, 100, 3),  0.009833530870726708), (("curBall", 160, 10, 0),  0.0), (("curBall", 160, 130, 2),  0.023381128383883478), (("curBall", 140, 80, 2),  0.0042352036734955145), (("vx-", 0),  -0.09255076941292463), (("curBall", 40, 100, 3),  0.009191963906581141), (("curBall", 170, 160, 2),  -0.003543043114071057), (("curBall", 40, 80, 3),  0.016207658803921426), (("curBall", 160, 80, 2),  0.0019799830734738206), (("agentPaddle", 40, 2),  -0.029675984941265044), (("curBall", 100, 40, 0),  0.0), (("curBall", 140, 20, 2),  -0.0355098578184486), (("curBall", 90, 140, 3),  0.0203884638352572), (("curBall", 60, 120, 3),  0.0016901998105718961), (("curBall", 70, 90, 3),  0.004273613248752092), (("curBall", 40, 40, 0),  -1.2895971477406511e-05), (("curBall", 70, 140, 0),  0.0), (("curBall", 140, 50, 3),  0.002759686315697173), (("curBall", 30, 50, 0),  0.0), (("curBall", 150, 50, 3),  0.001958433133532563), (("curBall", 160, 100, 0),  0.0), (("curBall", 130, 110, 2),  0.0017608712433765108), (("curBall", 160, 90, 0),  0.0), (("curBall", 40, 110, 3),  0.01604763338548582), (("curBall", 90, 130, 0),  3.241102901563687e-05), (("curBall", 60, 150, 2),  -0.007500810089007521), (("curBall", 170, 50, 3),  0.0004382471946462687), (("curBall", 50, 20, 2),  -0.09883843885817513), (("agentPaddle", 100, 0),  -0.04427694167650389), (("vy+", 0),  -0.1340404823963463), (("curBall", 30, 80, 2),  0.008895333023535174), (("curBall", 60, 70, 2),  0.007492888858272666), (("curBall", 150, 20, 3),  -0.005216737640478982), (("curBall", 120, 60, 3),  0.002125803515259358), (("curBall", 60, 70, 3),  0.0073800845597594995), (("curBall", 190, 110, 3),  -0.00627887570331181), (("curBall", 120, 70, 2),  0.008927249482777967), (("curBall", 80, 90, 2),  0.0027364186300693747), (("curBall", 130, 140, 3),  0.05124319631305965), (("curBall", 50, 80, 0),  5.032778958021991e-05), (("curBall", 110, 120, 3),  0.005117290730897112), (("curBall", 120, 70, 0),  0.0), (("curBall", 110, 140, 3),  0.0030589161922196105), (("curBall", 170, 80, 2),  -7.697243654716918e-06), (("curBall", 190, 0, 3),  -0.0727922097859315), (("curBall", 30, 40, 2),  0.013911011930155629), (("curBall", 50, 160, 3),  -0.003731387554789985), (("curBall", 120, 130, 0),  0.0), (("curBall", 130, 30, 0),  0.0), (("curBall", 40, 0, 0),  0.0), (("curBall", 160, 110, 2),  0.004332290840972657), (("agentPaddle", 90, 0),  -0.005659213500995276), (("curBall", 110, 30, 0),  -2.5934793768431412e-05), (("curBall", 150, 90, 2),  0.005564296000990238), (("curBall", 140, 90, 2),  0.005654924126309269), (("curBall", 170, 140, 0),  0.0), (("curBall", 40, 120, 3),  0.012775483291255274), (("curBall", 130, 60, 2),  0.0015374588989399984), (("curBall", 40, 70, 0),  0.0005572576673245538), (("curBall", 60, 50, 3),  0.009411302348419517), (("curBall", 180, 50, 2),  -0.0020925103702598), (("curBall", 130, 20, 2),  -0.0615744006867088), (("curBall", 100, 70, 0),  0.0), (("curBall", 50, 100, 3),  0.013194832613791566), (("curBall", 70, 40, 2),  0.0024755283730850636), (("curBall", 80, 140, 3),  0.003332005383075854), (("curBall", 80, 110, 0),  -0.00286202153433537), (("curBall", 60, 20, 3),  -0.04720812743354817), (("curBall", 180, 20, 2),  -0.017646778636174035), (("curBall", 40, 150, 3),  -0.25763442673918985), (("curBall", 50, 150, 3),  -0.05623266897945686), (("curBall", 100, 10, 2),  0.007040879026332916), (("curBall", 140, 60, 3),  0.00261809882824925), (("curBall", 140, 30, 0),  0.0), (("curBall", 100, 70, 2),  0.008122961252228552), (("curBall", 150, 150, 0),  -0.0025682585820692317), (("curBall", 100, 60, 3),  0.009080745916899897), (("curBall", 30, 100, 0),  0.0), (("curBall", 120, 150, 3),  -0.055875420293108664), (("curBall", 100, 130, 2),  0.0039029506364056748), (("curBall", 180, 160, 3),  -0.016934312643062503), (("curBall", 160, 140, 2),  0.013293626199089387), (("curBall", 100, 70, 3),  0.009595028288294559), (("curBall", 50, 10, 2),  3.212899901976703e-05), (("curBall", 60, 90, 3),  0.009172091053956855), (("curBall", 190, 20, 0),  0.0), (("curBall", 120, 110, 2),  0.005524087505137606), (("agentPaddle", 160, 3),  0.014396729734117637), (("curBall", 80, 50, 2),  0.006798994858791429), (("vy+", 3),  -0.13811675452031566), (("curBall", 30, 120, 3),  -0.00017508061877259185), (("curBall", 90, 40, 2),  0.006997883924625975), (("curBall", 90, 100, 3),  0.008379172767809378), (("curBall", 190, 130, 0),  0.0011573539441205169), (("curBall", 170, 120, 2),  0.008860598620983678), (("curBall", 130, 130, 3),  0.012851169304044122), (("curBall", 160, 120, 2),  0.012938595362894633), (("curBall", 190, 40, 3),  -0.00011174621184085575), (("agentPaddle", 130, 2),  -0.01428443785963497), (("curBall", 110, 70, 3),  0.015716943682413203), (("curBall", 110, 100, 0),  0.0), (("curBall", 140, 160, 0),  0.0), (("agentPaddle", 180, 0),  -0.01454765662422916), (("curBall", 40, 160, 2),  -0.16697444235834374), (("curBall", 140, 10, 3),  -7.471854058213063e-06), (("curBall", 100, 100, 0),  0.0), (("curBall", 90, 130, 3),  0.002997113751532615), (("curBall", 60, 70, 0),  0.0), (("curBall", 160, 150, 0),  -0.0043216470149952686), (("agentPaddle", 170, 3),  -0.0017797689168092224), (("curBall", 120, 160, 2),  -0.01684461286473779), (("curBall", 50, 60, 2),  0.006596861106703556), (("curBall", 170, 150, 3),  -0.008025672159021757), (("ballBelow", 3),  -0.06583029680909429), (("curBall", 30, 150, 3),  -0.010320818198975212), (("curBall", 40, 130, 0),  0.0), (("curBall", 150, 90, 0),  0.00025373757176686733), (("curBall", 40, 10, 2),  0.0004373426930067654), (("curBall", 140, 100, 2),  0.00250774537561592), (("curBall", 160, 70, 3),  0.002188349043532195), (("curBall", 110, 130, 3),  0.010244707253763597), (("curBall", 110, 160, 0),  0.0007301003404943144), (("curBall", 90, 40, 3),  0.003975916982829031), (("curBall", 170, 10, 0),  0.0), (("curBall", 130, 50, 2),  0.0016674031492468666), (("curBall", 70, 0, 2),  0.01819475949073528), (("curBall", 80, 100, 3),  0.0050731086235562065), (("curBall", 80, 70, 0),  -2.2252700113280117e-05), (("curBall", 60, 60, 3),  0.007299609383577856), (("curBall", 150, 120, 2),  0.01032351725856023), (("curBall", 60, 130, 0),  0.0), (("curBall", 50, 90, 3),  0.012276980644648381), (("curBall", 50, 120, 0),  0.0), (("curBall", 180, 10, 3),  0.009716704105243223), (("curBall", 120, 20, 0),  -0.0008373967405247679), (("agentPaddle", 0, 3),  0.0), (("curBall", 190, 70, 0),  0.0), (("curBall", 30, 110, 3),  0.0021872443143333723), (("curBall", 130, 80, 0),  0.0), (("curBall", 90, 30, 2),  0.0009564036662638216), (("curBall", 90, 90, 0),  0.0), (("curBall", 90, 130, 2),  0.0048232788834222965), (("curBall", 170, 70, 2),  0.002048288788943627), (("curBall", 190, 30, 3),  -0.0003891719399723131), (("curBall", 190, 60, 0),  0.0), (("curBall", 100, 80, 2),  0.006067323486219991), (("curBall", 100, 20, 0),  0.0022635307358198574), (("curBall", 160, 40, 3),  0.0013394837588696143), (("vx-", 2),  -0.085173995310496), (("curBall", 90, 60, 0),  0.0), (("curBall", 60, 90, 0),  0.0), (("curBall", 90, 120, 2),  0.005276731714932492), (("agentPaddle", 150, 2),  -0.02084627415630721), (("curBall", 110, 110, 3),  0.008129635955914252), (("vx+", 2),  -0.22402596350738335), (("curBall", 180, 90, 2),  -0.0003151926485402153), (("curBall", 160, 130, 3),  0.02391548506958314), (("curBall", 110, 20, 2),  -0.004081454855619722), (("curBall", 40, 20, 2),  0.007667502161448932), (("curBall", 170, 160, 3),  -0.016543239362991385), (("curBall", 40, 80, 0),  2.1433331841934498e-07), (("curBall", 160, 80, 3),  0.0020395805804862602), (("curBall", 60, 110, 0),  0.0), (("curBall", 140, 20, 3),  -0.034817807544163346), (("curBall", 70, 90, 0),  -6.483662877422197e-06), (("curBall", 80, 60, 2),  0.014127658950497632), (("curBall", 150, 110, 2),  0.01354963701016202), (("curBall", 150, 50, 0),  0.0), (("curBall", 90, 110, 2),  0.012149486290747441), (("curBall", 40, 50, 2),  0.013629754360935227), (("curBall", 180, 30, 0),  0.0), (("curBall", 130, 100, 0),  0.0061435168740902255), (("curBall", 60, 150, 3),  -0.034240475793615804), (("curBall", 170, 50, 0),  0.0), (("curBall", 100, 140, 2),  0.004784060606228666), (("curBall", 50, 20, 3),  -0.09613983130614041), (("curBall", 70, 120, 2),  0.015564510284582913), (("curBall", 30, 80, 3),  0.001111418538993778), (("curBall", 150, 80, 2),  0.0018511309250749228), (("curBall", 90, 150, 0),  0.0), (("curBall", 70, 30, 2),  -0.003048933780230692), (("curBall", 120, 60, 0),  0.0), (("curBall", 150, 130, 2),  0.030902138853537545), (("curBall", 70, 150, 0),  -6.675846597212273e-05), (("curBall", 120, 70, 3),  0.011622971818983146), (("curBall", 80, 90, 3),  0.005547464719590295), (("curBall", 170, 110, 2),  0.0005809001141528099), (("curBall", 120, 160, 3),  -0.05035253106987036), (("curBall", 70, 60, 0),  0.0), (("curBall", 120, 30, 2),  -0.000507066811410191), (("curBall", 150, 160, 0),  0.0), (("curBall", 170, 80, 3),  0.002171561663021261), (("curBall", 70, 110, 2),  0.004764178480355667), (("curBall", 30, 40, 3),  0.004153384078586063), (("curBall", 120, 120, 2),  0.00588838014921456), (("curBall", 70, 110, 3),  0.009991260634526279), (("curBall", 100, 150, 0),  -0.00760272810511144), (("agentPaddle", 160, 2),  -0.014600813534397914), (("curBall", 70, 110, 0),  0.0002187161760560232), (("curBall", 100, 110, 2),  0.0050877528642680366), (("curBall", 170, 100, 0),  0.0), (("curBall", 160, 110, 3),  0.0025615136789343355), (("agentPaddle", 80, 3),  -0.02168780533274305), (("curBall", 90, 0, 3),  0.0025736487885772443), (("curBall", 110, 60, 2),  0.0027416592809075746), (("curBall", 120, 90, 0),  0.0), (("curBall", 140, 90, 3),  0.0066287651858973435), (("curBall", 40, 60, 2),  0.016992143355503943), (("curBall", 40, 120, 0),  0.0), (("curBall", 130, 60, 3),  0.002122802328116389), (("curBall", 170, 100, 2),  0.002435809682122148), (("curBall", 80, 10, 0),  0.0), (("curBall", 180, 50, 3),  0.0008026606784844226), (("curBall", 50, 100, 2),  0.007527668431691571), (("curBall", 80, 20, 2),  -0.00917561876026278), (("curBall", 170, 0, 2),  0.055528925935989674), (("curBall", 130, 90, 3),  0.008347693911706571), (("curBall", 150, 70, 2),  0.0009776450879041988), (("curBall", 70, 40, 3),  0.0035517593043539837), (("curBall", 50, 80, 2),  0.008355420147868853), (("curBall", 40, 30, 0),  0.0), (("curBall", 60, 20, 0),  -0.001274228805962558), (("curBall", 180, 20, 3),  -0.011363284302403789), (("curBall", 30, 140, 0),  0.0), (("curBall", 50, 150, 0),  -0.0032961743072524646), (("agentPaddle", 170, 2),  -0.001488418251442935), (("curBall", 140, 60, 0),  0.0), (("curBall", 30, 30, 2),  0.03815519850920909), (("curBall", 70, 80, 2),  0.0009863483584240248), (("curBall", 100, 120, 2),  0.0014459604792380835), (("curBall", 180, 40, 2),  -0.0023405340192445842), (("curBall", 100, 60, 0),  0.0), (("curBall", 150, 100, 0),  0.0), (("curBall", 100, 130, 3),  0.005079084709325128), (("curBall", 180, 160, 0),  0.0), (("curBall", 160, 140, 3),  0.03440553599623566), (("curBall", 110, 10, 2),  0.032502665071627024), (("curBall", 90, 80, 2),  0.0018546436274140493), (("curBall", 50, 10, 3),  3.224140105997763e-05), (("curBall", 50, 40, 0),  0.0), (("curBall", 180, 120, 0),  0.0), (("curBall", 30, 60, 0),  0.0), (("curBall", 120, 110, 3),  0.005875340805127624), (("agentPaddle", 170, 0),  -0.019547375518532466), (("curBall", 80, 50, 3),  0.007226287562870484), (("curBall", 100, 30, 2),  0.002411182340700774), (("agentPaddle", 40, 0),  -0.059279746750862464), (("curBall", 180, 130, 2),  0.0030403444534759985), (("curBall", 130, 10, 2),  0.000329506474657888), (("curBall", 190, 160, 2),  -0.0134045545072193), (("curBall", 170, 120, 3),  0.007124512019484969), (("curBall", 130, 130, 0),  -0.00020429735455638345), (("curBall", 160, 120, 3),  0.010156560968100673), (("curBall", 180, 100, 2),  -0.0003673820823415806), (("curBall", 80, 10, 2),  0.002496885018885389), (("curBall", 110, 70, 0),  0.0), (("curBall", 120, 80, 2),  0.016442997764141792), (("curBall", 140, 130, 2),  0.019698770556841192), (("curBall", 40, 160, 3),  -0.16860608803602306), (("curBall", 130, 40, 0),  0.0), (("curBall", 90, 70, 2),  0.0021547249642735284), (("curBall", 130, 160, 2),  -0.0016420017000618), (("curBall", 180, 70, 0),  0.0), (("curBall", 120, 80, 0),  -1.744303914618931e-05), (("curBall", 50, 60, 3),  0.011721025102764567), (("curBall", 170, 150, 0),  -0.038166449607793314), (("curBall", 30, 150, 0),  0.0), (("curBall", 130, 20, 3),  -0.07091804009869715), (("curBall", 90, 100, 0),  0.0), (("curBall", 40, 10, 3),  0.00021557877179747336), (("curBall", 90, 160, 2),  -0.0506890601317694), (("curBall", 140, 100, 3),  0.005631260267454048), (("curBall", 140, 70, 0),  -0.00016639146829219915), (("curBall", 110, 130, 0),  4.3889187211241646e-05), (("curBall", 170, 40, 2),  -0.002153480356261627), (("curBall", 130, 50, 3),  0.0023282777094027983), (("curBall", 70, 0, 3),  0.03847079530404804), (("curBall", 80, 100, 0),  1.5400074789308452e-05), (("curBall", 70, 140, 3),  0.0030884954382778044), (("curBall", 140, 90, 0),  0.0), (("curBall", 60, 60, 0),  0.0), (("curBall", 150, 120, 3),  0.009908733503748986), (("curBall", 50, 90, 0),  7.136551670191746e-05), (("curBall", 30, 70, 2),  0.01926068312641386), (("curBall", 30, 110, 0),  0.0), (("curBall", 90, 30, 3),  0.00010640880510938934), (("curBall", 110, 50, 2),  0.006776049719550827), (("curBall", 60, 30, 2),  -0.014008630626931853), (("curBall", 190, 150, 2),  -0.11321774953140601), (("curBall", 40, 90, 2),  0.021721729817142328), (("curBall", 50, 140, 2),  0.03848163665873285), (("curBall", 170, 70, 3),  0.001107604058232526), (("curBall", 190, 90, 2),  -0.00173344525172529), (("curBall", 190, 30, 0),  0.0), (("curBall", 180, 90, 0),  0.0), (("vx+", 0),  -0.31168280479571403), (("curBall", 100, 80, 3),  0.00493154265193398), (("curBall", 80, 10, 3),  0.003361163552763796), (("curBall", 30, 140, 2),  0.0001999932795811523), (("curBall", 110, 110, 0),  0.0), (("curBall", 90, 120, 3),  0.0037179897693507572), (("curBall", 120, 80, 3),  0.02754878433923674), (("curBall", 160, 10, 2),  0.0), (("curBall", 120, 40, 2),  0.014192446290059054), (("curBall", 180, 90, 3),  0.0020055670167483546), (("curBall", 110, 20, 3),  -0.0035246712494755397), (("curBall", 150, 140, 0),  0.0), (("curBall", 40, 20, 3),  -0.015109554796618935), (("curBall", 160, 20, 2),  -0.018883402958538322), (("curBall", 160, 80, 0),  0.003357567155724226), (("curBall", 180, 60, 3),  0.0026834823461233557), (("curBall", 140, 140, 2),  0.05602689310360109), (("vy-", 0),  -0.24623418267372268), (("curBall", 140, 20, 0),  9.337364301562308e-05), (("agentPaddle", 0, 2),  0.0), (("curBall", 120, 10, 0),  0.0), (("curBall", 80, 60, 3),  0.005705771811347551), (("curBall", 80, 30, 0),  0.0007063277348373343), (("curBall", 70, 140, 2),  0.0007800052456853372), (("curBall", 150, 110, 3),  0.004071702522275956), (("agentPaddle", 120, 0),  -0.011666585678420468), (("curBall", 80, 150, 2),  -0.005181396455796817), (("curBall", 90, 110, 3),  0.008805237846509334), (("curBall", 40, 50, 3),  0.015114410684705374), (("curBall", 160, 50, 2),  0.0023230594515295765), (("curBall", 50, 50, 3),  0.010492964420450989), (("agentPaddle", 80, 2),  -0.029216542986804248), (("curBall", 170, 20, 0),  -0.004255493940494126), (("curBall", 100, 140, 3),  0.023931428958180925), (("curBall", 30, 20, 0),  0.0), (("curBall", 70, 120, 3),  0.008141091931505308), (("curBall", 60, 0, 2),  0.15941064921413275), (("curBall", 150, 80, 3),  0.0016652756381164945), (("curBall", 110, 0, 0),  0.0), (("curBall", 170, 130, 0),  0.0001283524863456365), (("curBall", 150, 130, 3),  0.021125589641993115), (("curBall", 30, 70, 3),  0.004240724455461301), (("curBall", 180, 60, 2),  0.00022632025784901416), (("curBall", 110, 90, 2),  0.012194222464023456), (("curBall", 100, 100, 3),  0.005598399396323788), (("curBall", 180, 40, 0),  0.0), (("curBall", 70, 70, 2),  0.0037961208174477124), (("curBall", 170, 110, 3),  0.0018848181512763952), (("curBall", 120, 160, 0),  0.0), (("agentPaddle", 140, 3),  -0.00019097562715117943), (("curBall", 120, 30, 3),  -0.001930586180169341), (("agentPaddle", 90, 2),  -0.017996556278039103), (("agentPaddle", 130, 3),  -0.004933105099514884), (("curBall", 50, 130, 2),  0.01091461427704567), (("agentPaddle", 60, 3),  -0.03213921245681635), (("agentPaddle", 50, 0),  -0.04061748339239199), (("curBall", 120, 120, 3),  0.005820451971252414), (("curBall", 70, 100, 0),  0.0010264249315793913), (("curBall", 80, 160, 2),  -0.0045650028129108075), (("curBall", 130, 150, 2),  -0.01836596575829273), (("agentPaddle", 150, 3),  -0.002448875504759106), (("curBall", 70, 90, 2),  0.002839016775650093), (("curBall", 100, 110, 3),  0.006954972526139124), (("curBall", 70, 130, 2),  0.01943341211891698), (("curBall", 110, 60, 3),  0.0028655242402332846), (("curBall", 170, 140, 2),  0.06150015922045158), (("curBall", 40, 60, 3),  0.016161210788814575), (("curBall", 190, 140, 0),  0.0), (("curBall", 50, 70, 2),  0.00257847923523848), (("curBall", 80, 20, 3),  -0.014501084286890134), (("curBall", 70, 160, 0),  0.0), (("curBall", 170, 0, 3),  0.004611725342014053), (("curBall", 130, 90, 0),  -0.00043549814824562653), (("curBall", 150, 70, 3),  0.0009446711515796642), (("curBall", 80, 110, 2),  0.01615939208625736), (("curBall", 120, 10, 2),  0.004825902311063228), (("curBall", 40, 90, 3),  0.016201839159740297), (("curBall", 180, 20, 0),  0.0), (("curBall", 100, 0, 2),  0.02154030707696038), (("curBall", 170, 30, 3),  -0.011300591424283723), (("curBall", 170, 60, 0),  0.0030298946226713693), (("curBall", 190, 140, 3),  0.005044124486157884), (("curBall", 30, 30, 3),  0.005439876441732281), (("curBall", 70, 80, 3),  0.005305574091174859), (("curBall", 100, 120, 3),  0.006781139920665796), (("curBall", 60, 40, 2),  0.0033992429744991778), (("curBall", 30, 100, 2),  0.000979988950707368), (("curBall", 80, 150, 0),  -0.0034827330688713028), (("curBall", 150, 40, 3),  0.00868224477407478), (("curBall", 160, 140, 0),  0.0), (("curBall", 110, 10, 3),  0.0022508123116395987), (("curBall", 110, 40, 0),  4.261635019319159e-05), (("curBall", 90, 80, 3),  0.002393027572054711), (("curBall", 50, 10, 0),  0.0), (("curBall", 190, 80, 0),  0.0), (("curBall", 190, 20, 2),  -0.0007282848373623744), (("curBall", 60, 10, 0),  0.0), (("curBall", 100, 30, 3),  -0.005675277245951455), (("curBall", 110, 150, 2),  -0.18267085940088384), (("curBall", 180, 130, 3),  0.003091579451142829), (("curBall", 120, 140, 2),  0.008030867344377376), (("curBall", 130, 10, 3),  -0.0002264234891066566), (("curBall", 190, 160, 3),  -0.05266129402481059), (("curBall", 160, 60, 2),  0.0009677179274900615), (("curBall", 160, 120, 0),  0.005379944172529554), (("curBall", 180, 100, 3),  0.004056273392690931), (("curBall", 50, 50, 2),  0.007123741034388927), (("curBall", 140, 40, 2),  0.003910781538248545), (("curBall", 110, 100, 2),  0.0025129875740168106), (("curBall", 140, 130, 3),  0.017311860328168435), (("curBall", 40, 100, 2),  0.006286823349468074), (("curBall", 40, 160, 0),  -0.06741490739560667), (("curBall", 160, 50, 0),  0.0), (("curBall", 90, 70, 3),  0.001660302328039246), (("curBall", 160, 30, 0),  -0.00011484053474521707), (("curBall", 130, 160, 3),  -0.0019097188692240013), (("curBall", 160, 90, 2),  0.003723310182019058), (("curBall", 50, 20, 0),  -0.006600053222427847), (("curBall", 160, 150, 2),  -0.04408157191528937), (("curBall", 110, 110, 2),  0.007417982910372414), (("curBall", 150, 30, 2),  0.0033784459157399035), (("curBall", 100, 10, 0),  0.0), (("curBall", 40, 130, 2),  0.00474602327400563), (("curBall", 70, 160, 2),  -0.012566107211225143), (("curBall", 150, 140, 2),  0.008014386510281933), (("curBall", 120, 100, 0),  0.0), (("curBall", 90, 160, 3),  -0.01901715397906356), (("curBall", 140, 100, 0),  0.00013881237220602952), (("curBall", 110, 160, 2),  -0.06872862201620679), (("curBall", 170, 40, 3),  0.00043254990160502855), (("curBall", 130, 50, 0),  0.0), (("curBall", 150, 60, 0),  0.0), (("curBall", 80, 70, 2),  0.004208894303809352), (("curBall", 60, 130, 2),  0.045319535927527244), (("curBall", 50, 120, 2),  0.0005355923739853883), (("curBall", 90, 150, 2),  -0.04671408698408428), (("curBall", 190, 100, 3),  -0.0015262871484298646), (("curBall", 130, 80, 2),  0.007187515222227025), (("curBall", 180, 150, 0),  1.04687050567973e-05), (("curBall", 90, 30, 0),  0.0), (("curBall", 110, 50, 3),  0.0036562704452778117), (("curBall", 110, 80, 0),  0.0), (("curBall", 60, 30, 3),  -0.009227905900873645), (("curBall", 190, 150, 3),  -0.1070364263889538), (("curBall", 120, 50, 0),  0.0), (("curBall", 50, 140, 3),  0.09098417642359624), (("curBall", 170, 70, 0),  -0.003702047605704535), (("curBall", 190, 90, 3),  -0.0007478581208806044), (("curBall", 190, 120, 0),  0.0), (("curBall", 190, 60, 2),  -0.0003845709559004127), (("curBall", 80, 160, 3),  -0.016851107962452157), (("curBall", 80, 130, 0),  0.0), (("curBall", 100, 80, 0),  0.0), (("curBall", 30, 140, 3),  0.0), (("curBall", 180, 0, 2),  0.08212968087347902), (("curBall", 90, 60, 2),  0.005940036600823286), (("ballSame", 2),  -0.09279461204430425), (("curBall", 50, 0, 2),  0.006059763665752295), (("vy-", 2),  -0.16083200573968873), (("curBall", 70, 20, 2),  -0.002341302315702963), (("curBall", 50, 110, 2),  0.0035717445428484177), (("curBall", 160, 10, 3),  -9.227302287030649e-06), (("curBall", 120, 40, 3),  0.0037705566215624773), (("curBall", 170, 130, 2),  0.026361508860755355), (("curBall", 40, 140, 2),  -0.004254140779839575), (("agentPaddle", 140, 2),  -0.008039918376058029), (("curBall", 40, 20, 0),  9.324633655675175e-05), (("curBall", 160, 20, 3),  -0.015326635830347417), (("curBall", 90, 140, 0),  0.0), (("curBall", 180, 60, 0),  0.0), (("curBall", 140, 140, 3),  0.06518685302368019), (("curBall", 140, 110, 0),  -0.0006122214401895175), (("curBall", 140, 50, 0),  0.0), (("agentPaddle", 50, 3),  -0.0349363418140779), (("curBall", 70, 30, 3),  0.001011389356446902), (("curBall", 100, 0, 3),  0.037595954621184605), (("curBall", 40, 110, 0),  -1.3723282772933824e-05), (("curBall", 100, 20, 2),  -0.008858532171296288), (("curBall", 150, 110, 0),  0.0006049060292821462), (("curBall", 70, 150, 2),  -0.017620505942339895), (("curBall", 80, 150, 3),  -0.017869464561985196), (("curBall", 90, 110, 0),  0.0), (("curBall", 70, 30, 0),  -0.004549106415070936), (("curBall", 160, 50, 3),  0.0015319688394100706), (("curBall", 180, 30, 2),  -0.0003176816709727731), (("curBall", 150, 140, 3),  0.00982110277047309), (("curBall", 70, 150, 3),  -0.03928663690378175), (("curBall", 30, 90, 2),  0.015761918354459573), (("curBall", 100, 90, 0),  0.0013648900055921165), (("curBall", 100, 140, 0),  0.0007021304654434027), (("curBall", 150, 20, 0),  0.0), (("curBall", 60, 0, 3),  0.06414596556106034), (("curBall", 190, 110, 0),  0.0), (("curBall", 30, 120, 0),  0.0), (("curBall", 30, 10, 0),  0.0), (("curBall", 140, 110, 2),  0.010052284615859743), (("curBall", 80, 120, 2),  0.01594181289304926), (("agentPaddle", 110, 0),  -0.013461407578757734), (("curBall", 130, 140, 0),  0.0), (("curBall", 180, 140, 3),  0.04464547840668704), (("curBall", 60, 140, 2),  0.05739701729283019), (("curBall", 110, 90, 3),  0.008483117519626668), (("curBall", 110, 120, 0),  0.00023630339638189437), (("curBall", 70, 70, 3),  0.0077558137495271915), (("curBall", 180, 140, 2),  0.0313613716045321), (("curBall", 170, 110, 0),  0.0), (("curBall", 190, 0, 0),  -0.05077397510548273), (("curBall", 50, 80, 3),  0.011540380272748523), (("curBall", 70, 60, 2),  0.0002958409250433751), (("ballBelow", 0),  -0.12778681677616782), (("curBall", 150, 160, 2),  -0.037353312045204624), (("curBall", 50, 130, 3),  0.020217258793081137), (("curBall", 50, 160, 0),  0.0), (("curBall", 120, 120, 0),  -1.7278695787791498e-05), (("curBall", 130, 150, 3),  -0.015958591224479426), (("curBall", 60, 80, 2),  0.003898069872121707), (("curBall", 120, 130, 3),  0.017219626436015024), (("curBall", 100, 150, 2),  -0.19826654394195337), (("curBall", 140, 120, 2),  0.01155054339071002), (("curBall", 70, 130, 3),  0.019556116500065886), (("curBall", 120, 90, 2),  0.013085457258744168), (("curBall", 170, 140, 3),  0.07325271881135917), (("curBall", 40, 60, 0),  0.0), (("curBall", 60, 50, 0),  0.0), (("curBall", 80, 90, 0),  3.259169348519069e-05), (("curBall", 50, 70, 3),  0.008647705276924779), (("curBall", 190, 50, 2),  -7.864630154813639e-05), (("agentPaddle", 0, 0),  0.018754105722595858), (("curBall", 110, 140, 0),  0.0), (("curBall", 80, 20, 0),  -0.007494079442696136), (("curBall", 30, 130, 3),  -0.001110045010733663), (("curBall", 40, 150, 0),  -0.12862315298103735), (("curBall", 150, 70, 0),  0.0), (("curBall", 60, 140, 0),  0.0), (("curBall", 100, 10, 3),  0.00010917153851031166), (("curBall", 40, 30, 2),  0.026427669661921793), (("curBall", 170, 30, 0),  0.0), (("curBall", 120, 150, 0),  0.0), (("curBall", 140, 30, 3),  -0.0018935751081947674), (("curBall", 30, 30, 0),  0.0), (("curBall", 100, 120, 0),  4.867301280289522e-05), (("curBall", 60, 40, 3),  0.015094426143464608), (("curBall", 50, 100, 0),  2.5774177831790642e-05), (("curBall", 30, 100, 3),  0.00010981524173076059), (("curBall", 150, 100, 2),  0.0014151919133115532), (("curBall", 110, 10, 0),  0.0), (("curBall", 70, 50, 2),  0.007442680142727055), (("curBall", 50, 40, 2),  0.006685996285035366), (("curBall", 80, 80, 2),  -0.002678404817250682), (("curBall", 190, 100, 0),  0.0), (("curBall", 190, 20, 3),  -0.004332177614770244), (("curBall", 30, 60, 2),  0.01060677779245248), (("curBall", 90, 50, 2),  0.006142109137810865), (("curBall", 100, 90, 2),  0.011731197127934535), (("curBall", 110, 150, 3),  -0.1764347378457106), (("curBall", 170, 90, 2),  -0.00023081090508065882), (("curBall", 190, 10, 3),  0.022547744175891674), (("curBall", 190, 40, 0),  0.0), (("curBall", 130, 10, 0),  0.0), (("curBall", 160, 60, 3),  0.002091212382845407), (("curBall", 180, 100, 0),  0.0), (("curBall", 140, 40, 3),  0.0014270254137665286), (("curBall", 140, 10, 0),  0.0), (("curBall", 110, 100, 3),  0.002253746682022846), (("curBall", 160, 40, 0),  0.0), (("curBall", 180, 110, 0),  0.0), (("curBall", 100, 40, 3),  0.0027575813151100134), (("curBall", 60, 120, 2),  0.003458912937398072), (("curBall", 130, 40, 2),  0.0036639857233879553), (("curBall", 90, 10, 2),  0.00037030371392505514), (("curBall", 90, 70, 0),  7.432836177680282e-05), (("curBall", 50, 30, 2),  -0.01392708730499956), (("curBall", 160, 90, 3),  0.0032568934205914946), (("curBall", 180, 70, 2),  -0.002807389006890542), (("curBall", 90, 20, 2),  -0.028876639470466987), (("agentPaddle", 190, 0),  -0.008706188316101515), (("curBall", 50, 130, 0),  0.0), (("curBall", 150, 30, 3),  0.0005187037702672949), (("curBall", 160, 70, 0),  0.0), (("curBall", 40, 130, 3),  0.008758271897126958), (("curBall", 90, 40, 0),  0.0), (("curBall", 90, 100, 2),  0.015517157683325018), (("curBall", 140, 70, 2),  0.004028762229538535), (("curBall", 110, 160, 3),  -0.022241673234935956), (("curBall", 80, 70, 3),  0.0037128133350717626), (("curBall", 180, 10, 0),  0.0), (("curBall", 130, 160, 0),  0.0), (("curBall", 90, 20, 0),  0.0006758394193596444), (("agentPaddle", 100, 3),  -0.04671914605365259), (("curBall", 60, 130, 3),  0.035848457572689535), (("curBall", 150, 40, 2),  0.00584785354605626), (("curBall", 80, 140, 0),  0.0), (("agentPaddle", 50, 2),  -0.031095654102141292), (("curBall", 50, 120, 3),  0.007600420648233007), (("agentPaddle", 70, 2),  -0.04315850458504303), (("curBall", 60, 110, 2),  0.008509125099867445), (("curBall", 90, 150, 3),  -0.06193848391107312), (("curBall", 130, 80, 3),  0.007014735581154821), (("ballSame", 0),  -0.10419669749170662), (("curBall", 110, 50, 0),  0.0), (("curBall", 190, 150, 0),  -0.02911825943703594), (("curBall", 80, 40, 2),  0.007772450633744551), (("curBall", 190, 90, 0),  0.0), (("curBall", 120, 130, 2),  0.012196477549985594), (("curBall", 190, 60, 3),  0.0003816127771149368), (("curBall", 80, 160, 0),  0.0), (("curBall", 160, 160, 2),  -0.0447279193839662), (("curBall", 100, 40, 2),  0.00961709316867838), (("curBall", 30, 160, 0),  0.0), (("curBall", 90, 60, 3),  0.007224540084936022), (("curBall", 80, 60, 0),  -9.496259358831484e-05), (("curBall", 50, 0, 3),  0.014180502085296578), (("curBall", 160, 110, 0),  0.0), (("agentPaddle", 110, 3),  -0.014938058900320173), (("curBall", 160, 130, 0),  0.0), (("agentPaddle", 30, 0),  -0.07789037162355487), (("curBall", 50, 110, 3),  0.007523589400872589), (("curBall", 120, 40, 0),  0.0), (("curBall", 170, 130, 3),  0.030351269466993406), (("curBall", 170, 160, 0),  0.0), (("curBall", 40, 140, 3),  0.009508378831213473), (("curBall", 180, 80, 0),  0.0), (("curBall", 110, 30, 2),  0.006107888053621383), (("curBall", 160, 20, 0),  0.0), (("curBall", 50, 50, 0),  0.0), (("curBall", 60, 110, 3),  0.009965161301265978), (("curBall", 140, 140, 0),  0.0), (("curBall", 30, 50, 2),  0.006995069498067538), (("curBall", 190, 140, 2),  0.000658739918110683), (("ballSame", 3),  -0.07157991054395801), (("curBall", 100, 0, 0),  0.0), (("curBall", 90, 0, 2),  0.0021102030595432707), (("curBall", 60, 150, 0),  2.8723554683011063e-05), (("curBall", 120, 150, 2),  -0.07535340830350473), (("curBall", 120, 100, 2),  0.001825474522191868), (("curBall", 180, 30, 3),  -0.0007164067444480914), (("curBall", 170, 20, 2),  -0.049806012142335966), (("curBall", 130, 110, 3),  0.006120156307726285), (("curBall", 30, 80, 0),  0.0), (("curBall", 30, 20, 2),  0.008699677395922936), (("curBall", 60, 0, 0),  0.0), (("curBall", 180, 0, 3),  0.12029456695823064), (("curBall", 70, 10, 0),  0.0), (("curBall", 110, 0, 2),  0.15434429222048554), (("ballBelow", 2),  -0.15739905556685085), (("curBall", 30, 10, 2),  -0.00010927381701874561), (("curBall", 140, 110, 3),  0.0074967012016097685), (("curBall", 80, 120, 3),  0.006489276287570486), (("curBall", 50, 0, 0),  0.0), (("curBall", 180, 140, 0),  0.006578619999750589), (("curBall", 60, 140, 3),  0.05538564083621063), (("curBall", 180, 160, 2),  -0.029687264068502462), (("curBall", 110, 90, 0),  0.0), (("curBall", 70, 70, 0),  0.0), (("curBall", 170, 80, 0),  0.0), (("curBall", 30, 40, 0),  0.0), (("curBall", 70, 60, 3),  0.0030304611006184527), (("curBall", 150, 160, 3),  -0.010360450831227174), (("curBall", 190, 100, 2),  -0.0007009748729775372), (("curBall", 180, 110, 2),  -0.0008509956324514571), (("curBall", 40, 10, 0),  0.0), (("curBall", 130, 30, 2),  -0.007685162869420736), (("curBall", 70, 100, 2),  -0.001928374558011454), (("curBall", 40, 0, 2),  0.004853951024909209), (("curBall", 130, 150, 0),  0.0), (("curBall", 60, 80, 3),  0.00816228842223874), (("curBall", 180, 80, 2),  -0.0017698946552422786), (("curBall", 100, 150, 3),  -0.12113044712920068), (("agentPaddle", 180, 3),  -0.00301055206196958), (("curBall", 90, 0, 0),  0.0), (("curBall", 140, 120, 3),  0.0070372494483981335), (("curBall", 70, 10, 2),  0.012444680791147127), (("agentPaddle", 60, 2),  -0.029841198837058554), (("curBall", 100, 100, 2),  0.016115676841496944), (("curBall", 70, 130, 0),  0.0), (("curBall", 130, 60, 0),  0.0), (("curBall", 120, 90, 3),  0.0055147599660005635), (("vx-", 3),  -0.08001418054251669), (("curBall", 180, 50, 0),  1.233966361609725e-05))
        self.weights = defaultdict(float)
        #for k, v in s:
            #self.weights[k] = v
        self.numIters = 0

    # Return the Q function associated with the weights and features
    def getQ(self, state, action):
        score = 0
        for f, v in self.featureExtractor(state, action):
            score += self.weights[f] * v
        return score

    # This algorithm will produce an action given a state.
    # Here we use the epsilon-greedy algorithm: with probability
    # |explorationProb|, take a random action.
    def getAction(self, state, done):
        if done:
            return 0
        self.numIters += 1
        if random.random() < self.explorationProb:
            for i in range(35, 195):
                row = state[1][i]
                #ball is in row
                if [236, 236, 236] in row:
                    return 2 #go up
                #paddle is in row
                if [92, 186, 92] in row:
                    return 3 #go down
            #do nothing
            return 0
        else:
            return max((self.getQ(state, action), action) for action in self.actions)[1]

    # Call this function to get the step size to update the weights.
    def getStepSize(self):
        return 1.0 / math.sqrt(self.numIters)

    # We will call this function with (s, a, r, s'), which you should use to update |weights|.
    # Note that if s is a terminal state, then s' will be None.  Remember to check for this.
    # You should update the weights using self.getStepSize(); use
    # self.getQ() to compute the current estimate of the parameters.
    def incorporateFeedback(self, state, action, reward, newState):
        # BEGIN_YOUR_CODE (our solution is 12 lines of code, but don't worry if you deviate from this)
        if newState != None:
            Vopt = max(self.getQ(newState, a) for a in self.actions)
            for feature, value in self.featureExtractor(state, action):
                self.weights[feature] -= self.getStepSize()*(self.getQ(state, action) - (reward + self.discount*Vopt))*value
        # END_YOUR_CODE

    def getWeights(self):
        return self.weights

def getxy(obs, pixel):
    for i in range(35, 195):
        row = obs[i]
        for j in range(len(row)):
            if row[j].tolist() == pixel:
                ballxy = [i, j]
                return ballxy
    return [0, 0]

def round(x):
    divided = (int(x)/10)*10
    if math.fabs(x - divided) > math.fabs(x -(divided + 10)):
        return divided + 10
    return divided

#state is tuple of prevObservation, curObservation
def featureExtractorXY(state, action):
    features = []
    prevBall = getxy(state[0], [236, 236, 236])
    curBall = getxy(state[1], [236, 236, 236])
    agentPaddle = getxy(state[1], [92, 186, 92])[0]
    opPaddle = getxy(state[1], [213, 130,74])[0]
    xvelocity = curBall[1] - prevBall[1]
    yvelocity = curBall[0] - prevBall[0]

    if xvelocity > 0:
        features.append((("vx+", action), 1))
    else:
        features.append((("vx-", action), 1))
    
    if yvelocity > 0:
        features.append((("vy+", action), 1))
    else:
        features.append((("vy-", action), 1))
    

    if curBall[0] - agentPaddle > 36:
        features.append((("ballBelow", action), 1))
    elif curBall[0] - agentPaddle > 0:
        features.append((("ballSame", action), 1))
    else:
        features.append((("ballAbove", action), 1))
    if curBall != [0, 0]:
        features.append((("curBall", round(curBall[0]), round(curBall[1]), action), 1))
    features.append((("agentPaddle", round(agentPaddle), action), 1))
    return features


class QLearningAgent(object):
    def __init__(self, action_space):
        self.action_space = action_space

    def act(self, observation, reward, done, q):
        return q.getAction(observation, done)



if __name__ == '__main__':
    logger.set_level(logger.WARN)

    #Opens a Pong environment
    env = gym.make('Pong-v0')

    #directory to output game statistics
    outdir = 'tmp/results'
    env = wrappers.Monitor(env, directory=outdir, force=True)
    env.seed(0)
    agent = QLearningAgent(env.action_space)

    num_games = 1000
    reward = 0
    done = False
    q = QLearningAlgorithm([0, 2, 3], discount = 1, featureExtractor = featureExtractorXY, explorationProb=0.8)

    #plays num_games number of games 
    for i in range(num_games):
        new_observation = env.reset()
        observation = new_observation
        prev_obs = observation
        while True:
            #env.render() #allows video of game in progress to be shown 
            action = agent.act((observation, new_observation), reward, done, q)
            prev_obs = observation
            observation = new_observation
            new_observation, reward, done, _ = env.step(action) #go to next action
            if reward != 0:
                print reward
            q.incorporateFeedback((prev_obs, observation), action, reward, (observation, new_observation))
            #the end of the game has been reached
            if done:
                break
        print q.getWeights()
    #Closes the environment            
    env.close()
